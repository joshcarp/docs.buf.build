---
id: npm
title: NPM
---

The Buf Schema Registry provides remote packages for [JavaScript][JavaScript] and
[TypeScript][TypeScript]: consume generated
SDKs from modules and plugins using dependency management tools like [NPM][npm]
and [Yarn][Yarn].

This provides consumers of your API with generated SDKs on demand. With
generated SDKs, you no longer need to generate code from Protobuf locally, and
thus no longer need for consumers to pull in Protobuf files or perform any
generation whatsoever.

## Setup

JavaScript and TypeScript source code generated by the BSR is hosted on the
**BSR's NPM registry** at:

:::note

buf.build/gen/npm/v1

:::

NPM is configured to use the public NPM registry at
[registry.NPMjs.org][npm-registry] by default. To configure NPM to use Buf's NPM
registry for the `@buf` package scope, use this command to [set][npm-config] your
NPM config:

```terminal
$ npm config set @buf:registry https://buf.build/gen/npm/v1
```

This updates your global [`.npmrc`][npmrc] to fetch `@buf/*` packages from the BSR.
You can configure [Yarn] in an analogous way:

```terminal
$ yarn config set @buf:registry https://buf.build/gen/npm/v1
```

### Using private packages {#private}

To install NPM packages generated from private [Buf modules][modules], you need
to configure npm to send an authentication token with each request to the BSR
npm registry.

```terminal
$ npm config set //buf.build/gen/npm/v1/:_authToken {token}
```

This command will add an entry to your [`.npmrc`][npmrc] file:

<Syntax
    title=".npmrc token syntax"
    examples={["//buf.build/gen/npm/v1/:_authToken=84612b6cbe8f4..."]}
    segments={[
        {separator: "//"},
        {label: "buf.build/gen/npm/v1", kind: "constant"},
        {separator: "/:"},
        {label: "_authToken", kind: "constant"},
        {separator: "="},
        {label: "token", kind: "variable"}
    ]}
/>

You can use an existing auth token or generate a new one. To create a new one,
log into the [BSR][bsr], navigate to your [user settings][settings] page, and
click **Create Token**.

## Using the NPM Registry

The BSR NPM registry has a special syntax for package names:


import Syntax from "@site/src/components/Syntax";

<Syntax
    title="Package name syntax"
    examples={["npm install @buf/bufbuild_eliza.bufbuild_connect-web"]}
    segments={[
        {label: "npm install", kind: "constant"},
        {separator: " "},
        {label: "@buf", kind: "constant"},
        {separator: "/"},
        {label: "{moduleOwner}", kind: "constant"},
        {separator: "_"},
        {label: "{moduleName}", kind: "constant"},
        {separator: "."},
        {label: "{pluginOwner}", kind: "constant"},
        {separator: "_"},
        {label: "{pluginName}", kind: "constant"}
    ]}
/>

In this example, `@buf/bufbuild_eliza.bufbuild_connect-web`, the BSR generates
code for the [`bufbuild/eliza`](https://buf.build/bufbuild/eliza) module using
the [`bufbuild/connect-web`](https://buf.build/bufbuild/connect-web) plugin.

## Installing packages {#npm-install}

With your npm config [set](#setup), you can install `@buf/*`
[packages](#package-names) in any standard npm project. Here's an example
installation command:

```terminal
$ npm install @buf/bufbuild_eliza.bufbuild_connect-web
```

:::info Slow installation?

You may notice that installing packages from the BSR
npm registry using `npm install` can take longer than installing from the
standard npm registry. This happens because packages are generated "on the
fly"&mdash;that is, they're lazily generated and then cached. The first
`npm install` typically takes longer than subsequent requests.

:::

You can use _any_ plugin that generates Javascript/Typescript, which can
simplify Protobuf workflows down to two steps:

1. `buf push` your [module][modules] to the BSR
1. `npm install` your generated NPM package

## Versions

By default, when you `npm install` a [Buf module][modules], the BSR generates
code from the most recent [reference](../overview.mdx#referencing-a-module) for
the module. But you can also install a specific package version using npm's
standard `@` syntax referencing an explicit version or a draft name.

```terminal
$ npm install @buf/bufbuild_eliza.bufbuild_connect-web
```

### Latest

If you do not specify a version, npm will fetch `@latest` by default, which
resolves to the package version syntax described below.

```terminal
$ npm install @buf/bufbuild_eliza.bufbuild_connect-web@latest
```

### Draft

The BSR supports [draft commits][bsr-references]. This feature enables you to
push unreleased proto changes and consume generated code without affecting the
main branch.

```terminal
$ buf push --draft dev-draft
$ npm install @buf/bufbuild_eliza.bufbuild_connect-web@dev-draft
```

The package version for drafts will contain a zero-based timestamp so you can
easily differentiate between your main branch versus those that originate from a
draft.

```
0.2.1-00000000000000-9bb41b97ede9.3
```

### Full Syntax

<Syntax
    title="NPM version syntax"
    examples={["0.2.1-20220706172350-dbde79169a01.3"]}
    segments={[
        {label: "pluginVersion", kind: "variable"},
        {separator: "-"},
        {label: "moduleTimestamp", kind: "variable"},
        {separator: "-"},
        {label: "moduleCommit", kind: "variable"},
        {separator: "."},
        {label: "pluginRevision", kind: "variable"}
    ]}
/>

With package versions (valid [semver][semver]):

- The version core is the plugin version **0.2.1**
- The semver pre-release version is composed of:
- module commit timestamp (YYYYMMDDHHMMSS) **20220706172350**
- module commit short name (12 characters) **dbde79169a01**
- The final identifier is the plugin revision **3** for the plugin version

Most users will likely use `@latest`, but if you need to reference a package
version explicitly you can do so like this:

```terminal
$ npm install @buf/bufbuild_eliza.bufbuild_connect-web@0.2.1-20220706172350-dbde79169a01.3
```

## Other package managers

Because the BSR NPM registry implements npm's [public registry
API][registry-api], you should be able to use it with package management tools
outside of npm, such as [Yarn] and [pnpm], though with some known limitations:

Please be aware that [Yarn] versions greater than [v1.10.0][yarn_v1] and less
than [v2][yarn_v2] are _not_ supported. These versions of Yarn require the
`shasum` field in the dist object to be set, but the BSR can't compute a digest
without generating the code for all possible versions of the package.

## Available plugins {#plugins}

For a full list of supported plugins navigate to the [BSR plugins
page][bsr-plugins] and search for JavaScript and TypeScript.

To learn more about how these plugins are packaged and distributed check out the
[bufbuild/plugins repository][bufbuild-plugins]. If you find a useful plugin
that should be added please [file an issue][bufbuild-plugins-issue]!

[bsr-plugins]: https://buf.build/plugins
[bufbuild-plugins]: https://github.com/bufbuild/plugins
[bufbuild-plugins-issue]: https://github.com/bufbuild/plugins/issues/new/choose
[javascript]: https://developer.mozilla.org/en-US/docs/Web/JavaScript
[modules]: /bsr/overview#modules
[npm]: https://npmjs.org
[typescript]: https://www.typescriptlang.org/
[bsr]: /bsr/overview
[bsr-references]: /bsr/overview#referencing-a-module
[modules]: /bsr/overview#modules
[npm-config]: https://docs.npmjs.com/cli/v8/commands/npm-config#set
[npmrc]: https://docs.npmjs.com/cli/v8/configuring-npm/npmrc
[pnpm]: https://pnpm.io
[npm-registry]: https://registry.npmjs.org
[registry-api]: https://github.com/npm/registry/blob/master/docs/REGISTRY-API.md
[semver]: https://semver.org
[settings]: https://buf.build/settings/user
[yarn]: https://yarnpkg.com
[yarn_v1]: https://github.com/yarnpkg/yarn/releases/tag/v1.10.0
[yarn_v2]: https://github.com/yarnpkg/berry
